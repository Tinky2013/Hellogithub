---
layout:     post                    # 使用的布局（不需要改）
title:      滑动平均模型与自回归滑动平均模型               # 标题 
subtitle:   时间序列分析 第三章 #副标题
date:       2019-11-03             # 时间
author:     WZY                      # 作者
header-img: img/post-bg-universe.jpg    #这篇文章标题背景图片
catalog: true                       # 是否归档
mathjax: true
tags:                               #标签
    - stats
--- 

# 时间序列分析 第三章 滑动平均模型与自回归滑动平均模型

## 3.1 滑动平均模型

滑动平均模型其实是这样一种模型：由白噪声的有限线性组合来描述平稳序列，当k比q大的时候自协方差函数为零而$\gamma_q≠0$，此时就是q步相关的平稳序列。

> 比如$X_t=\varepsilon_t+\hat{b}\varepsilon_{t-1}, t\in \mathbb{Z}$，其特点就是$k>1$时，$\gamma_k=E(X_tX_{t+k})=0$


### 3.1.1 MA(q)模型和MA(q)序列

**定义1.1 MA(q)模型**：$\varepsilon_t$是白噪声$WN(0,\sigma^2)$，若

$$B(z)=1+\sum_{j=1}^qb_jz^j≠0,\ |z|<1$$

其中$b_q≠0$, 则

$$X_t=\varepsilon_t+\sum_{j=1}^q b_j\varepsilon_{t-j}$$

为q阶滑动平均模型，$\{X_t\}$就是MA(q)序列。我们可以加强条件要求$\|z\|≤1$时也有$B(z)≠0$，这时候这个序列就是**可逆**MA(q)序列。

>**1）可逆表明了$X_t$与$\varepsilon_t$可以相互线性表示**
>>既然有$X_t=B(\mathscr{B})\varepsilon_t$，$\varepsilon_t$可以写作t时刻前观测值的线性和：
>>
>>$$\varepsilon_t=B^{-1}(\mathscr{B})X_t=\sum_{j=0}^\infty\psi_jX_{t-j}$$
>>
>>这里利用了$B^{-1}(z)$在z≤1时的Taylor展开式系数$\psi_j$。
>
>这个在可逆的时候可以用，也就真正说明了可逆的含义
>
>**2）由于MA(q)序列是白噪声的有限滑动和，因此相比AR(p)振荡较轻，稳定性要好**（自协方差函数截尾、谱密度平坦也可以体现这一点）


**定理1.1**：MA(q)序列的自协方差函数是q后截尾的：

$$\gamma_q=\sigma^2b_q≠0，\gamma_k=0, |k|>q$$

且有谱密度：

$$f(\lambda)=\frac{\sigma^2}{2\pi}|B(e^{i\lambda})|^2=\frac{1}{2\pi}\sum_{k=-q}^q\gamma_ke^{-ik\lambda}$$

>计算上我们可以直接算出自协方差函数(令$b_0=1$以及算出$EX_t=0$)：
$$\gamma_k=E(X_tX_{t+k})=
\begin{cases}
\sigma^2\sum_{j=0}^{q-k}b_jb_{j+k}, 0≤k≤q\\
0, k>q
\end{cases}$$

**引理2.1**：设$\{c_j\}$使得$c_p≠0$和$g(\lambda)=\frac{1}{2\pi}\sum_{j=-q}^qc_je^{-ij\lambda}≥0$，$\lambda\in[-\pi,\pi]$，则有唯一的实系数多项式

$$B(z)=1+\sum_{j=1}^qb_jz^j≠0,\ |z|<1, b_q≠0$$

使得

$$g(\lambda)=\frac{\sigma^2}{2\pi}|B(e^{i\lambda})|^2$$

>这里很显然我们可以用根与系数关系得到$c_j=c_{-j}$，引理的证明主要是用$G(z)=\sum_{j=-q}^qc_jz^j$的对称性，2q个根中如果z是根则其倒数也必是根。所以只需要取其中那个不在单位圆内的根就可以组成$B(.)$

**定理1.3**：零均值平稳序列$\{X_t\}$有自协方差函数$\{\gamma_k\}$，则是MA(q)序列的充分必要条件是$\gamma_q≠0，\gamma_k=0, \|k\|>q$

>**1）证明**：使用线性滤波的谱密度公式
>
>**2）这个定理说明零均值平稳序列，如果自协方差函数q后截尾，则这个平稳序列一定是MA(q)序列。**

关于最小序列、MA(q)序列递推求解以及MA(q)序列举例内容可参考何书元《时间序列分析》P92-96

## 3.2 自回归滑动平均模型

### 3.2.1 ARMA(p,q)模型及其平稳解

**定义2.1 ARMA(p,q)模型**：$\varepsilon_t$是白噪声$WN(0,\sigma^2)$，有：

$$A(z)=1-\sum_{j=1}^p a_jz^j≠0, |z|≤1$$

$$B(z)=\sum_{j=0}^q b_jz^j≠0, |z|<1$$

则

$$X_t=\sum_{j=1}^pa_jX_{t-j}+\sum_{j=0}^q b_j\varepsilon_{t-j}$$

是一个自回归滑动平均模型，同样，如果要求B(z)在单位圆上也无根，则为可逆的ARMA模型。

**定理2.1**：

$$X_t=A^{-1}(\mathscr{B})B(\mathscr{B})\varepsilon_t=\sum_{j=0}^\infty\psi_j\varepsilon_{t-j}$$

定义的平稳序列$\{X_t\}$是ARMA(p,q)模型的唯一平稳解。

>这里$\psi_k$就是$\{X_t\}$的Wold系数，也是$A^{-1}(z)B(z)$的Taylor展开系数。

### 3.2.2 ARMA(p,q)序列的自协方差函数

$$\gamma_k=\sigma^2\sum_{j=0}^\infty\psi_j\psi_{j+k},\ k≥0$$

>可以通过ARMA模型的参数递推计算:
>
>$$\psi_j=\begin{cases}
1,j=0\\b_j+\sum_{k=1}^pa_k\psi_{j-k}, j=1,2,...\end{cases}$$
>
>规定$b_j=0(j>q),\ \psi_j<0(j<0)$，证明使用级数乘法的比较系数。

### 3.2.3 ARMA(p,q)模型的可识别性

**定理2.3**：设$\{\gamma_k\}$为ARMA(p,q)序列$\{X_t\}$的自协方差函数列，则m≥p时，矩阵$\Gamma_n$可逆。

$$\Gamma_n=\begin{bmatrix}
\gamma_q&\gamma_{q-1}&...&\gamma_{q-m+1}\\
\gamma_{q+1}&\gamma_q&...&\gamma_{q-m+2}\\
...&&&...\\
\gamma_{q+m-1}&\gamma_{q+m-2}&...&\gamma_q
\end{bmatrix}$$

> **1) A(z)和B(z)没有公因子，则模型参数$(a_1,...,a_p,b_1,...,b_q,\sigma^2)$可由平稳解的自协方差函数唯一决定。**
>
>**2) 只要$\Gamma_{p,q}$可逆，则ARMA(p,q)序列的自协方差函数和模型参数可相互唯一决定**
>
>**3)** 这个定理为ARMA模型参数的矩估计提供了理论保证

**定理2.4**：设零均值平稳序列$\{X_t\}$有自协方差函数$\{\gamma_k\}$，有系数使得$A(z)$满足最小相位条件和

$$\gamma_k-\sum_{j=1}^p a_j\gamma_{k-j}=
\begin{cases}
c≠0, k=q\\
0, k>q
\end{cases}$$

则$\{X_t\}$是一个$ARMA(p',q')$序列，其中p'≤p，q'≤q。

### 3.2.4 ARMA(p,q)序列的谱密度和可逆性

有理谱密度：由于ARMA序列的自协方差函数绝对可和，所以有谱密度：

$$f(\gamma)=\frac{1}{2\pi}\sum_{k=-\infty}^\infty\gamma_ke^{-ik\lambda}=\frac{\sigma^2}{2\pi}|\frac{B(e^{i\lambda})}{A(e^{i\lambda})}|^2$$

## 3.3 广义ARMA模型和ARIMA(p,d,q)模型介绍

### 3.3.1 广义ARMA模型

设$A(z)=1-\sum_{j=1}^pa_jz^j,\ B(z)=1+\sum_{j=1}^qb_jz^j$没有公共根，$a_pb_p≠0$而没有其他限制，则差分方程

$$A(\mathscr{B})X_t=B(\mathscr{B})\varepsilon_t$$

为广义ARMA(p,q)模型

> **1)** 给定初值$x_0,x_{-1},...$可以由系数和白噪声递推出之后的x
>
> **2)** A(Z)在单位圆上有根，则没有平稳解；在单位圆上没有根时有唯一平稳解
>
> $$X_t=A^{-1}(\mathscr{B})B(\mathscr{B})\varepsilon_t=\sum_{j=-\infty}^\infty c_j\varepsilon_{t-j}$$
>
> 然而如果在单位圆内有根，则t的观测受到t以后白噪声的影响（双边无穷滑动和），同时解随着时间增加而加速振荡（爆炸模型）

### 3.3.2 求和ARIMA(p,d,q)模型

d为正整数，$Y_t=(1-\mathscr{B})^dX_t=\sum_{k=0}^dC_d^k(-1)^kX_{t-k}$是一个ARMA(p,q)序列，就称$\{X_t\}$是一个求和ARIMA(p,d,q)模型：

$$A(\mathscr{B})(1-\mathscr{B})^dX_t=B(\mathscr{B})\varepsilon_t$$

> **1)** 这里A、B满足的条件和ARMA相同实质上就是对观察数据进行d次差分处理
>
> **2)** d通常取1或2，$\{X_t\}$是非平稳序列
