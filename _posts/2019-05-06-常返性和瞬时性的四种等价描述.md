---
layout:     post                    # 使用的布局（不需要改）
title:      常返性和瞬时性的四种等价描述              # 标题 
subtitle:    #副标题
date:       2019-05-06             # 时间
author:     WZY                      # 作者
header-img: img/graph.jpg    #这篇文章标题背景图片
catalog: true                       # 是否归档
mathjax: true
tags:                               #标签
    - stats
--- 

## 1 基本理解

### 1.1 互通等价类

在描述马尔可夫链的时候，每个状态的返回性质显得相当重要，在讨论常反与瞬时之前，先引入一个概念，叫互通。

互通是什么，简而言之，就是如果i→j且j→i，那么这两个状态就是互通的。在马尔科夫链中，互通是一种等价关系的表达（具有对称、传递、自反等性质），有了互通等价类，
我们就能对状态空间进行分解（分解成不交的互通等价类的并）。而互通等价类拥有相同的周期性和常返性，因此判断一个状态的性质时，也可以从它的等价类中找出一个容易判断的状态来判断。

### 1.2 常返和暂留的引入

为什么引入常返和暂留，因为我们希望能够回答如下问题：

* （1）对于马尔可夫链而言，从一个状态出发**是否一定能**在有限时间内返回这个状态？这个问题的是否回答决定了是常返还是暂留。

* （2）如果能够返回，那么平均返回时间是否有限？这个问题的回答决定了是正常反还是零常返。

* （3）如果能够返回，那么平均返回时间的精确值是多少？这个问题就需要用后面的平稳分布来回答了。

## 2 四种等价描述

### 2.1 等价关系的描述

关于常返与瞬时的判别标准看起来很复杂，有很多种方法，就如下图所示，但其实在某种程度上这是统一的，只是从不同的角度进行了描述。

![](https://github.com/Tinky2013/My-class-expansion/raw/master/img/071-7480-1.JPG)

第一种描述意味着，如果j常返，那么从j出发能以概率1在有限时间内返回j；如果j暂留，则从j出发以正概率不再返回j。

第二种描述意味着，如果j常返，那么从j出发能够以概率1返回j无数多次，所以我们才把这种状态叫做**常返**！而如果j暂留，那么这个求和就一定是个有限数，即不可能无数次返回j。

第三种描述意味着，如果j常返，那么从j出发能够以概率1返回j无数多次，很显然这种描述和第二种是等价的。只不过第二种用了全概率公式的思想来描述这件事情，而这里直接把返回次数M给列出来放到一个概率的表达式中。右边的图解也可以更好理解这个思想。

第四种描述意味着，常返的j会以概率1在有限时间内返回j的，这和第一种描述其实是完全一样的。

### 2.2 做题的思路

所以，从上面可以看到，判断常返还是瞬时最方便的方式就是计算$\sum_{n=1}^{\infty} f_{jj}^{(n)}$，看看这个东西是等于1还是小于1的；另外，判断正常返还是零常返，就顺带算一下$\sum_{n=1}^{\infty} nf_{jj}^{(n)}$看看是不是无穷，这玩意儿是无穷大了意味着你虽然能够回来，但是回来时间的期望其实是无穷大的。
当然，判断常返和瞬时另一种方法可以用互通等价类（开的一定暂留，有限闭集一定正常返）。

图中第五条式子大概是最常用判断正常返与零常返的式子了，本质上就是看看返回时间的期望是否无穷，这个期望我们便起了一个很洋气的名字，叫“平均回转时”。

另外一个正常返与零常返的重要区别就是第六条式子。注意零常返中2和6的区别，n趋于无穷的时候n步返回j的概率趋于零，但是它还是常返的，所以所有这样的概率加起来还是趋于无穷的。

## 3 如何沟通几种判别视角

常返和瞬时中很重要的一个关系就是$p_{ij}^{(n)}$和$f_{ij}^{(n)}$的关系，我们用全概率+划分的思想沟通这两者，，也就是：

$$p_{ij}^{(n)}=\sum_{k=1}^n f_{ij}^{(k)}p_{jj}^{(n-k)}$$

这条式子的意思就是，从i出发n步到j相当于第一次到j以及从j开始在回到j的各种情况之和。（可以从某个状态正常返利用控制收敛定理推出任意两个状态也会成立）
