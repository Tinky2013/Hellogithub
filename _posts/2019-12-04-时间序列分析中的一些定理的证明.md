---
layout:     post                    # 使用的布局（不需要改）
title:      时间序列分析中的一些定理的证明               # 标题 
subtitle:    #副标题
date:       2019-12-04             # 时间
author:     WZY                      # 作者
header-img: img/post-bg-universe.jpg    #这篇文章标题背景图片
catalog: true                       # 是否归档
mathjax: true
tags:                               #标签
    - stats
--- 

# 时间序列分析中的一些定理的证明

在时间序列中有一些经典的证明，其中的思想有值得借鉴的地方，很多定理只要转化一下就会变得非常显然，因此在这里总结一下，加深对于这些定理的理解。

## 1 平稳序列自协方差函数的性质

**定理** 对于平稳序列，其自协方差函数满足以下性质

* 对称性：$\gamma_k=\gamma_{-k}$
* 自协方差矩阵非负定性
* 有界性：$\|\gamma_k\|\leq\gamma_0$

（定理来自《应用时间序列分析》何书元P15）

**证明**

![](https://github.com/Tinky2013/My-class-expansion/raw/master/img/time%20series%20analysis/15.jpg)

其中对称性就是包含在自协方差函数的定义之中的。

要证明非负定性，其实就是对于任意一个向量，$\mathbf{a}^T\mathbf{\Gamma}\mathbf{a}$大于等于零，但是我们将这条式子代入展开后，可以发现角标i和j所表示的完全相同，因此可以改变角标化为平方的形式（或者方差的形式），这个形式一定是非负的。

证明有界性可以直接利用Schwarz不等式，这个不等式保证了有界性。

## 2 平稳序列自协方差矩阵正定的条件

**定理**

* 若$\{X_t\}$的谱密度$f(\lambda)$存在，则$\Gamma_n$正定。
* 当$k\rightarrow\infty$时，$\gamma_k\rightarrow 0$，，则$\Gamma_n$正定。

（定理来自《应用时间序列分析》何书元P73）

**证明**

这里只给出第一行的证明：

![](https://github.com/Tinky2013/My-class-expansion/raw/master/img/time%20series%20analysis/73.jpg)

这里证明的思路和上一个定理非常像，其实这里需要额外证明的就是不等于零。我们看到这个定理对于时间序列的二阶矩的存在性进行了限制，这个时候结论也变成了正定。本质上还是因为方差$\gamma_0$是正数。

## 3 线性平稳序列的滤波公式

**定理**

$$Y_t=\sum_{j=-\infty}^\infty h_j X_{t-j}$$

平稳序列$X_t$的输出序列如上，则有谱密度：

$$f_Y(\lambda)=|H(e^{-i\lambda})|^2 f_X(\lambda)$$

（定理来自《应用时间序列分析》何书元P46）

**证明**

![](https://github.com/Tinky2013/My-class-expansion/raw/master/img/time%20series%20analysis/46.jpg)

想要推谱密度，首先需要推导Y的自协方差函数，之后利用谱密度的定义即可，可以看到这里也对于等价的下标进行了合并，从而换成平方的形式，并利用控制收敛定理保证求和符号位置改变的可行性。

## 4 用自协方差函数表示平稳序列的谱密度

**定理** 平稳序列$\{X_t\}$的自协方差函数绝对可和，则$X_t$有谱密度：

$$f(\lambda)=\frac{1}{2\pi}\sum_{k=-\infty}^\infty \gamma_k e^{-ik\lambda}$$

（定理来自《应用时间序列分析》何书元P67）

**证明**

![](https://github.com/Tinky2013/My-class-expansion/raw/master/img/time%20series%20analysis/67.jpg)

证明其实就是把谱密度的定义用一下，不过比较重要的就是我们需要去验证这个谱密度是非负的，这里用到了Kronecker引理：

如果$b_n$单调上升趋于$\infty$，复数列$a_n$使得$\sum_{n\geq 1}a_n$收敛，则有

$$lim_{n\rightarrow\infty}\frac{1}{b_n}\sum_{j=1}^n b_j a_j=0$$

## 5 AR(p)序列及其偏相关系数

**定理** 零均值平稳序列$\{X_t\}$是AR(p)序列的充分必要条件是，它的偏相关系数$a_{n,n}$在$p$后截尾。

（定理来自《应用时间序列分析》何书元P79）

**证明**

![](https://github.com/Tinky2013/My-class-expansion/raw/master/img/time%20series%20analysis/79.jpg)

这个定理的证明结构比较清晰。其实必要性比较显然，通过AR(p)自协方差矩阵的性质加上Yule-Walker方程即可说明截尾（事实上这就是定义的一部分），那么我们需要证明的就是“偏相关系数p后截尾的零均值平稳序列一定是AR(p)序列”。

充分性的证明分为三步，首先是利用Levinson递推公式将Yule-Walker系数表示出来，接着利用Yule-Walker方程构造出平稳序列，最后通过证明白噪声证明AR(p)序列。

## 6 MA(q)序列及其自协方差函数

**定理** 零均值平稳序列$\{X_t\}$是MA(q)序列的充分必要条件是，它的自协方差函数$\gamma_k$在$q$后截尾。

（定理来自《应用时间序列分析》何书元P91）

**证明**

![](https://github.com/Tinky2013/My-class-expansion/raw/master/img/time%20series%20analysis/91.jpg)

必要性是可以直接将MA(q)序列定义的基本形式通过计算算出的，充分性的证明分为如下几个步骤：

* 使用P91的引理1.2（其实是一个复变函数论中的定理），同时如果假定$f(\lambda)$恒正，则存在多项式$B(z)$在单位圆内和圆上都没有根。

* 上一步的多项式条件保证了能够构造出平稳序列$\{\varepsilon_t\}$。

* 证明$\varepsilon_t$是白噪声即可。

## 7 平稳序列自协方差函数的渐近无偏估计

**定理** 平稳序列的样本自协方差函数满足: $k\rightarrow\infty$时$\gamma_k\rightarrow 0$，则对每个确定的k，$\hat{\gamma}_k$是$\gamma_k$的渐近无偏估计：

$$lim_{N\rightarrow\infty}E\hat{\gamma}_k=\gamma_k$$

（定理来自《应用时间序列分析》何书元P129）

**证明**

![](https://github.com/Tinky2013/My-class-expansion/raw/master/img/time%20series%20analysis/129.jpg)

证明渐近无偏性本质上就是求期望再取极限，这种构造性证明还是比较常见的，将自协方差函数的估计量的后面两项分别通过Schwarz不等式和均方收敛性取极限收敛到0即可。
